<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bakal.ai — Plateforme de prospection intelligente</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg-primary: #0a0b0f;
  --bg-secondary: #12131a;
  --bg-card: #161722;
  --bg-card-hover: #1c1d2e;
  --bg-elevated: #1e1f32;
  --border: #252638;
  --border-light: #2a2b40;
  --text-primary: #eeeef2;
  --text-secondary: #8b8ca0;
  --text-muted: #5c5d72;
  --accent: #6c5ce7;
  --accent-light: #a29bfe;
  --accent-glow: rgba(108, 92, 231, 0.15);
  --success: #00d68f;
  --success-bg: rgba(0, 214, 143, 0.1);
  --warning: #ffaa00;
  --warning-bg: rgba(255, 170, 0, 0.1);
  --danger: #ff6b6b;
  --danger-bg: rgba(255, 107, 107, 0.1);
  --blue: #339af0;
  --blue-bg: rgba(51, 154, 240, 0.1);
  --purple: #9775fa;
  --orange: #ff922b;
  --radius: 12px;
  --radius-sm: 8px;
  --radius-lg: 16px;
  --shadow: 0 4px 24px rgba(0,0,0,0.3);
}

* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Outfit', sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  overflow-x: hidden;
  min-height: 100vh;
}

/* ═══════════ SIDEBAR ═══════════ */
.sidebar {
  position: fixed; left: 0; top: 0; bottom: 0;
  width: 260px;
  background: var(--bg-secondary);
  border-right: 1px solid var(--border);
  padding: 24px 16px;
  display: flex; flex-direction: column;
  z-index: 100;
}
.logo {
  display: flex; align-items: center; gap: 12px;
  padding: 0 8px 24px; margin-bottom: 8px;
  border-bottom: 1px solid var(--border);
}
.logo-icon {
  width: 36px; height: 36px;
  background: linear-gradient(135deg, var(--accent), var(--accent-light));
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-weight: 800; font-size: 16px; color: white;
}
.logo-text { font-weight: 700; font-size: 20px; letter-spacing: -0.5px; }
.logo-text span { color: var(--accent-light); }

.nav { margin-top: 16px; flex: 1; }
.nav-section { margin-bottom: 24px; }
.nav-label {
  font-size: 10px; font-weight: 600; letter-spacing: 1.5px;
  color: var(--text-muted); text-transform: uppercase;
  padding: 0 12px; margin-bottom: 8px;
}
.nav-item {
  display: flex; align-items: center; gap: 12px;
  padding: 10px 12px; border-radius: var(--radius-sm);
  color: var(--text-secondary); font-size: 14px; font-weight: 400;
  cursor: pointer; transition: all 0.2s;
  margin-bottom: 2px;
}
.nav-item:hover { background: var(--bg-card); color: var(--text-primary); }
.nav-item.active {
  background: var(--accent-glow); color: var(--accent-light);
  font-weight: 500;
}
.nav-item .icon { font-size: 18px; width: 22px; text-align: center; }
.nav-item .badge {
  margin-left: auto; background: var(--accent);
  color: white; font-size: 11px; font-weight: 600;
  padding: 2px 8px; border-radius: 10px;
}

.sidebar-footer {
  border-top: 1px solid var(--border); padding-top: 16px;
}
.user-card {
  display: flex; align-items: center; gap: 10px;
  padding: 8px; border-radius: var(--radius-sm);
}
.user-avatar {
  width: 34px; height: 34px; border-radius: 8px;
  background: linear-gradient(135deg, #ff6b6b, #ffa94d);
  display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: 13px; color: white;
}
.user-info { flex: 1; }
.user-name { font-size: 13px; font-weight: 600; }
.user-plan { font-size: 11px; color: var(--text-muted); }

/* ═══════════ MAIN ═══════════ */
.main { margin-left: 260px; padding: 32px; }

.page-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 32px;
}
.page-title { font-size: 28px; font-weight: 700; letter-spacing: -0.5px; }
.page-subtitle { color: var(--text-secondary); font-size: 14px; margin-top: 4px; }
.header-actions { display: flex; gap: 12px; }

.btn {
  padding: 10px 20px; border-radius: var(--radius-sm);
  font-family: 'Outfit', sans-serif; font-size: 13px; font-weight: 600;
  cursor: pointer; transition: all 0.2s; border: none;
  display: flex; align-items: center; gap: 8px;
}
.btn-primary {
  background: linear-gradient(135deg, var(--accent), #7c6cf0);
  color: white; box-shadow: 0 4px 16px rgba(108, 92, 231, 0.3);
}
.btn-primary:hover { transform: translateY(-1px); box-shadow: 0 6px 24px rgba(108, 92, 231, 0.4); }
.btn-ghost {
  background: var(--bg-card); color: var(--text-secondary);
  border: 1px solid var(--border);
}
.btn-ghost:hover { border-color: var(--accent); color: var(--text-primary); }
.btn-success { background: var(--success); color: #0a0b0f; }

/* ═══════════ TAB NAV ═══════════ */
.tabs {
  display: flex; gap: 0; margin-bottom: 28px;
  border-bottom: 1px solid var(--border);
}
.tab {
  padding: 12px 20px; font-size: 14px; font-weight: 500;
  color: var(--text-muted); cursor: pointer; position: relative;
  transition: color 0.2s;
}
.tab:hover { color: var(--text-secondary); }
.tab.active { color: var(--accent-light); }
.tab.active::after {
  content: ''; position: absolute; bottom: -1px; left: 0; right: 0;
  height: 2px; background: var(--accent); border-radius: 2px 2px 0 0;
}

/* ═══════════ KPI CARDS ═══════════ */
.kpi-grid {
  display: grid; grid-template-columns: repeat(6, 1fr); gap: 16px;
  margin-bottom: 32px;
}
.kpi-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 20px;
  transition: all 0.3s;
}
.kpi-card:hover { border-color: var(--border-light); transform: translateY(-2px); }
.kpi-label { font-size: 12px; color: var(--text-muted); font-weight: 500; margin-bottom: 8px; }
.kpi-value { font-size: 28px; font-weight: 700; letter-spacing: -1px; }
.kpi-trend { font-size: 12px; margin-top: 6px; display: flex; align-items: center; gap: 4px; }
.kpi-trend.up { color: var(--success); }
.kpi-trend.down { color: var(--danger); }
.kpi-trend.neutral { color: var(--text-muted); }

/* ═══════════ SECTION GRID ═══════════ */
.section-grid {
  display: grid; grid-template-columns: 2fr 1fr; gap: 24px;
  margin-bottom: 32px;
}
.section-full { grid-column: 1 / -1; }

.card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-lg); overflow: hidden;
}
.card-header {
  padding: 20px 24px; display: flex; align-items: center;
  justify-content: space-between; border-bottom: 1px solid var(--border);
}
.card-title { font-size: 15px; font-weight: 600; display: flex; align-items: center; gap: 8px; }
.card-body { padding: 24px; }

/* ═══════════ CAMPAIGNS TABLE ═══════════ */
.campaign-table { width: 100%; border-collapse: collapse; }
.campaign-table th {
  text-align: left; font-size: 11px; font-weight: 600;
  color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px;
  padding: 0 16px 16px;
}
.campaign-table td { padding: 14px 16px; border-top: 1px solid var(--border); font-size: 14px; }
.campaign-table tr:hover td { background: rgba(108, 92, 231, 0.03); }

.status-badge {
  padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 600;
  display: inline-flex; align-items: center; gap: 5px;
}
.status-active { background: var(--success-bg); color: var(--success); }
.status-prep { background: var(--warning-bg); color: var(--warning); }
.status-done { background: var(--blue-bg); color: var(--blue); }

.perf-bar {
  width: 60px; height: 6px; background: var(--bg-elevated);
  border-radius: 3px; overflow: hidden;
}
.perf-fill { height: 100%; border-radius: 3px; }
.perf-good { background: var(--success); }
.perf-ok { background: var(--warning); }
.perf-bad { background: var(--danger); }

/* ═══════════ WEEKLY REPORT ═══════════ */
.report-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 20px;
  margin-bottom: 12px; transition: all 0.2s;
}
.report-card:hover { border-color: var(--accent); }
.report-header {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 16px;
}
.report-week { font-weight: 600; font-size: 15px; }
.report-date { font-size: 12px; color: var(--text-muted); }
.report-score {
  padding: 4px 12px; border-radius: 6px; font-size: 12px; font-weight: 600;
}
.score-excellent { background: rgba(51, 154, 240, 0.15); color: var(--blue); }
.score-good { background: var(--success-bg); color: var(--success); }
.score-ok { background: var(--warning-bg); color: var(--warning); }

.report-metrics {
  display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px;
  margin-bottom: 16px;
}
.report-metric { text-align: center; }
.report-metric-value { font-size: 20px; font-weight: 700; }
.report-metric-label { font-size: 11px; color: var(--text-muted); margin-top: 2px; }

.report-synthesis {
  background: var(--bg-elevated); border-radius: var(--radius-sm);
  padding: 14px 16px; border-left: 3px solid var(--accent);
}
.report-synthesis-label {
  font-size: 11px; font-weight: 600; color: var(--accent-light);
  margin-bottom: 6px; display: flex; align-items: center; gap: 6px;
}
.report-synthesis-text { font-size: 13px; color: var(--text-secondary); line-height: 1.5; }

/* ═══════════ CHART AREA ═══════════ */
.chart-container {
  height: 200px; position: relative; padding: 16px 0;
}
.chart-bars {
  display: flex; align-items: flex-end; gap: 8px; height: 100%;
  padding: 0 8px;
}
.chart-bar-group { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 6px; }
.chart-bar-wrapper { display: flex; gap: 3px; align-items: flex-end; height: 160px; }
.chart-bar {
  width: 14px; border-radius: 4px 4px 0 0; transition: all 0.3s;
  opacity: 0.85;
}
.chart-bar:hover { opacity: 1; }
.chart-bar.email { background: var(--blue); }
.chart-bar.linkedin { background: var(--purple); }
.chart-bar-label { font-size: 10px; color: var(--text-muted); }
.chart-legend {
  display: flex; gap: 16px; justify-content: center;
  margin-top: 12px;
}
.chart-legend-item { display: flex; align-items: center; gap: 6px; font-size: 12px; color: var(--text-secondary); }
.chart-legend-dot { width: 8px; height: 8px; border-radius: 2px; }

/* ═══════════ CAMPAIGN CREATOR ═══════════ */
.creator-overlay {
  display: none; position: fixed; inset: 0;
  background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
  z-index: 200; align-items: center; justify-content: center;
}
.creator-overlay.show { display: flex; }
.creator-modal {
  background: var(--bg-secondary); border: 1px solid var(--border);
  border-radius: var(--radius-lg); width: 720px; max-height: 85vh;
  overflow-y: auto; box-shadow: 0 24px 80px rgba(0,0,0,0.5);
  animation: slideUp 0.3s ease;
}
@keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
.creator-header {
  padding: 24px 28px; border-bottom: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
}
.creator-header h2 { font-size: 20px; font-weight: 700; }
.creator-close {
  width: 32px; height: 32px; border-radius: 8px; border: none;
  background: var(--bg-card); color: var(--text-muted); font-size: 18px;
  cursor: pointer; display: flex; align-items: center; justify-content: center;
}
.creator-body { padding: 28px; }
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
.form-group { display: flex; flex-direction: column; gap: 6px; }
.form-group.full { grid-column: 1 / -1; }
.form-label { font-size: 12px; font-weight: 600; color: var(--text-secondary); }
.form-select, .form-input {
  padding: 10px 14px; border-radius: var(--radius-sm);
  background: var(--bg-card); border: 1px solid var(--border);
  color: var(--text-primary); font-family: 'Outfit', sans-serif;
  font-size: 14px; outline: none; transition: border-color 0.2s;
  -webkit-appearance: none;
}
.form-select:focus, .form-input:focus { border-color: var(--accent); }

.inspiration-toggle {
  grid-column: 1 / -1; display: flex; align-items: center;
  gap: 14px; padding: 16px 20px; background: var(--accent-glow);
  border: 1px solid rgba(108, 92, 231, 0.2); border-radius: var(--radius);
  cursor: pointer; transition: all 0.2s;
}
.inspiration-toggle:hover { border-color: var(--accent); }
.toggle-switch {
  width: 44px; height: 24px; background: var(--bg-elevated);
  border-radius: 12px; position: relative; transition: background 0.2s;
  flex-shrink: 0;
}
.toggle-switch.on { background: var(--accent); }
.toggle-switch::after {
  content: ''; position: absolute; width: 18px; height: 18px;
  background: white; border-radius: 50%; top: 3px; left: 3px;
  transition: transform 0.2s;
}
.toggle-switch.on::after { transform: translateX(20px); }
.inspiration-text h4 { font-size: 14px; font-weight: 600; margin-bottom: 2px; }
.inspiration-text p { font-size: 12px; color: var(--text-muted); }

.creator-footer {
  padding: 20px 28px; border-top: 1px solid var(--border);
  display: flex; justify-content: flex-end; gap: 12px;
}

/* ═══════════ INSPIRATION PANEL ═══════════ */
.inspiration-panel {
  display: none; grid-column: 1 / -1;
  background: var(--bg-elevated); border-radius: var(--radius);
  border: 1px solid var(--accent); padding: 20px;
  animation: fadeIn 0.3s ease;
}
.inspiration-panel.show { display: block; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
.inspi-header {
  display: flex; align-items: center; gap: 10px; margin-bottom: 16px;
}
.inspi-icon {
  width: 32px; height: 32px; border-radius: 8px;
  background: linear-gradient(135deg, var(--accent), var(--accent-light));
  display: flex; align-items: center; justify-content: center; font-size: 16px;
}
.inspi-title { font-weight: 600; }
.inspi-sub { font-size: 12px; color: var(--text-muted); }

.inspi-suggestion {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-sm); padding: 16px; margin-top: 12px;
}
.inspi-suggestion h5 { font-size: 14px; font-weight: 600; margin-bottom: 10px; color: var(--accent-light); }
.inspi-params {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;
}
.inspi-param {
  background: var(--bg-secondary); border-radius: 6px; padding: 8px 12px;
}
.inspi-param-label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
.inspi-param-value { font-size: 13px; font-weight: 600; margin-top: 2px; }
.inspi-reason {
  margin-top: 12px; padding: 12px; background: rgba(0, 214, 143, 0.05);
  border-left: 3px solid var(--success); border-radius: 0 6px 6px 0;
  font-size: 13px; color: var(--text-secondary); line-height: 1.5;
}
.inspi-actions { margin-top: 16px; display: flex; gap: 10px; }

/* ═══════════ LIVE PULSE ═══════════ */
.pulse-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: var(--success); display: inline-block;
  animation: pulse 2s infinite;
}
@keyframes pulse {
  0%, 100% { box-shadow: 0 0 0 0 rgba(0, 214, 143, 0.4); }
  50% { box-shadow: 0 0 0 6px rgba(0, 214, 143, 0); }
}

/* ═══════════ SCROLLBAR ═══════════ */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

/* ═══════════ REFINEMENT A/B ═══════════ */
.refine-overview {
  display: grid; grid-template-columns: 1fr 1fr; gap: 20px;
  margin-bottom: 28px;
}
.refine-stat-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 24px; text-align: center;
}
.refine-stat-value { font-size: 36px; font-weight: 700; margin-bottom: 4px; }
.refine-stat-label { font-size: 13px; color: var(--text-muted); }

.variant-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-lg); overflow: hidden; margin-bottom: 16px;
  transition: all 0.3s;
}
.variant-card:hover { border-color: var(--border-light); }
.variant-card.winner { border-color: var(--success); box-shadow: 0 0 20px rgba(0,214,143,0.1); }
.variant-card.testing { border-color: var(--warning); }

.variant-header {
  padding: 18px 24px; display: flex; align-items: center;
  justify-content: space-between; border-bottom: 1px solid var(--border);
}
.variant-name { font-weight: 600; font-size: 15px; display: flex; align-items: center; gap: 10px; }
.variant-badge {
  padding: 3px 10px; border-radius: 6px; font-size: 11px; font-weight: 600;
}
.variant-badge.winner { background: var(--success-bg); color: var(--success); }
.variant-badge.testing { background: var(--warning-bg); color: var(--warning); }
.variant-badge.control { background: var(--blue-bg); color: var(--blue); }

.variant-body { padding: 20px 24px; }
.variant-message {
  background: var(--bg-elevated); border-radius: 8px; padding: 16px;
  font-size: 13px; line-height: 1.7; color: var(--text-secondary);
  margin-bottom: 16px; border-left: 3px solid var(--accent);
}
.variant-message .subject { color: var(--text-primary); font-weight: 600; margin-bottom: 8px; }

.variant-metrics {
  display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;
}
.variant-metric { text-align: center; padding: 12px; background: var(--bg-elevated); border-radius: 8px; }
.variant-metric-value { font-size: 20px; font-weight: 700; }
.variant-metric-label { font-size: 11px; color: var(--text-muted); margin-top: 2px; }

.refine-timeline {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-lg); padding: 24px; margin-top: 24px;
}
.refine-timeline-title { font-weight: 600; font-size: 15px; margin-bottom: 20px; display: flex; align-items: center; gap: 8px; }

.timeline-item {
  display: flex; gap: 16px; padding: 12px 0;
  border-bottom: 1px solid var(--border);
}
.timeline-item:last-child { border-bottom: none; }
.timeline-dot {
  width: 10px; height: 10px; border-radius: 50%; margin-top: 5px; flex-shrink: 0;
}
.timeline-dot.green { background: var(--success); }
.timeline-dot.blue { background: var(--blue); }
.timeline-dot.orange { background: var(--warning); }
.timeline-dot.purple { background: var(--purple); }

.timeline-content { flex: 1; }
.timeline-action { font-size: 13px; font-weight: 500; margin-bottom: 2px; }
.timeline-detail { font-size: 12px; color: var(--text-muted); }
.timeline-date { font-size: 11px; color: var(--text-muted); white-space: nowrap; }

.learning-card {
  background: var(--bg-elevated); border-radius: 8px; padding: 14px;
  margin-top: 8px; border-left: 3px solid var(--purple);
}
.learning-card .label { font-size: 11px; font-weight: 600; color: var(--purple); margin-bottom: 4px; }
.learning-card .text { font-size: 12px; color: var(--text-secondary); line-height: 1.5; }

/* ═══════════ VARIABLE GENERATOR ═══════════ */
.vargen-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-lg); margin-bottom: 24px;
  overflow: hidden;
}
.vargen-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 20px 24px; border-bottom: 1px solid var(--border);
  background: linear-gradient(135deg, rgba(108,92,231,0.06), rgba(162,155,254,0.04));
}
.vargen-header-left { display: flex; align-items: center; gap: 14px; }
.vargen-header-icon {
  width: 42px; height: 42px; border-radius: 12px;
  background: linear-gradient(135deg, var(--accent), var(--accent-light));
  display: flex; align-items: center; justify-content: center;
  font-size: 18px; flex-shrink: 0;
}
.vargen-header-title { font-size: 16px; font-weight: 700; }
.vargen-header-subtitle { font-size: 12px; color: var(--text-muted); margin-top: 2px; }

.vargen-context {
  display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
  padding: 16px 24px; border-bottom: 1px solid var(--border);
  background: var(--bg-secondary);
}
.vargen-context-label {
  font-size: 11px; font-weight: 600; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 0.5px;
}
.vargen-context-tag {
  padding: 4px 12px; border-radius: 6px; font-size: 12px; font-weight: 500;
  background: var(--bg-elevated); color: var(--text-secondary);
  border: 1px solid var(--border);
}
.vargen-context-tag.highlight {
  background: var(--accent-glow); color: var(--accent-light);
  border-color: rgba(108,92,231,0.3);
}

.vargen-body { padding: 24px; }

.vargen-explanation {
  background: var(--bg-elevated); border-radius: var(--radius);
  padding: 18px 20px; margin-bottom: 24px;
  border-left: 3px solid var(--accent);
}
.vargen-explanation-title {
  font-size: 13px; font-weight: 600; color: var(--accent-light);
  margin-bottom: 8px; display: flex; align-items: center; gap: 8px;
}
.vargen-explanation-text {
  font-size: 13px; color: var(--text-secondary); line-height: 1.7;
}

.vargen-chain {
  display: flex; flex-direction: column; gap: 0;
  margin-bottom: 24px;
}
.vargen-chain-label {
  font-size: 11px; font-weight: 700; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 1px;
  margin-bottom: 12px;
}

.vargen-var {
  background: var(--bg-elevated); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 18px 20px;
  transition: all 0.2s; position: relative;
}
.vargen-var:hover { border-color: var(--accent); }
.vargen-var + .vargen-connector {
  display: flex; align-items: center; justify-content: center;
  padding: 6px 0;
}
.vargen-connector-arrow {
  width: 2px; height: 24px; background: var(--border);
  position: relative;
}
.vargen-connector-arrow::after {
  content: '▼'; position: absolute; bottom: -6px; left: 50%;
  transform: translateX(-50%); font-size: 8px; color: var(--accent-light);
}
.vargen-var.derived {
  border-color: var(--accent); background: rgba(108,92,231,0.05);
  box-shadow: 0 0 20px rgba(108,92,231,0.08);
}

.vargen-var-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 10px;
}
.vargen-var-name {
  display: flex; align-items: center; gap: 10px;
}
.vargen-var-tag {
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px; font-weight: 600;
  color: var(--accent-light); background: rgba(108,92,231,0.15);
  padding: 4px 12px; border-radius: 6px;
}
.vargen-var-type {
  font-size: 10px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.5px; padding: 3px 8px; border-radius: 4px;
}
.vargen-var-type.base { background: var(--blue-bg); color: var(--blue); }
.vargen-var-type.derived { background: var(--accent-glow); color: var(--accent-light); }
.vargen-var-type.enrichment { background: var(--warning-bg); color: var(--warning); }

.vargen-var-actions { display: flex; gap: 6px; }

.vargen-var-desc {
  font-size: 13px; color: var(--text-secondary); line-height: 1.5;
  margin-bottom: 10px;
}
.vargen-var-source {
  display: flex; align-items: center; gap: 6px;
  font-size: 11px; color: var(--text-muted);
}
.vargen-var-source-icon {
  width: 16px; height: 16px; border-radius: 4px;
  display: flex; align-items: center; justify-content: center;
  font-size: 9px; background: var(--bg-card);
}

/* Formula editor for derived variables */
.vargen-formula {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-sm); padding: 14px 16px;
  margin-top: 12px;
}
.vargen-formula-label {
  font-size: 10px; font-weight: 700; color: var(--accent-light);
  text-transform: uppercase; letter-spacing: 0.5px;
  margin-bottom: 8px; display: flex; align-items: center; gap: 6px;
}
.vargen-formula-inputs {
  display: flex; align-items: center; gap: 8px; flex-wrap: wrap;
  margin-bottom: 10px;
}
.vargen-formula-input-tag {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; color: var(--blue); background: var(--blue-bg);
  padding: 3px 8px; border-radius: 4px; border: 1px solid rgba(51,154,240,0.2);
}
.vargen-formula-operator {
  font-size: 14px; color: var(--text-muted); font-weight: 600;
}
.vargen-formula-prompt {
  width: 100%; padding: 10px 14px; border-radius: var(--radius-sm);
  background: var(--bg-elevated); border: 1px solid var(--border);
  color: var(--text-primary); font-size: 13px; line-height: 1.5;
  font-family: 'Outfit', sans-serif; resize: vertical; min-height: 60px;
  transition: border-color 0.2s;
}
.vargen-formula-prompt:focus { outline: none; border-color: var(--accent); }

/* AI Preview */
.vargen-preview {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-sm); margin-top: 12px; overflow: hidden;
}
.vargen-preview-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 14px; border-bottom: 1px solid var(--border);
  background: var(--bg-secondary);
}
.vargen-preview-title {
  font-size: 11px; font-weight: 600; color: var(--text-muted);
  display: flex; align-items: center; gap: 6px;
}
.vargen-preview-body { padding: 14px 16px; }
.vargen-preview-example {
  display: flex; gap: 12px; padding: 8px 0;
  border-bottom: 1px solid var(--border);
  font-size: 12px;
}
.vargen-preview-example:last-child { border-bottom: none; }
.vargen-preview-prospect {
  font-weight: 600; color: var(--text-primary);
  min-width: 120px; flex-shrink: 0;
}
.vargen-preview-value {
  color: var(--text-secondary); line-height: 1.5;
}
.vargen-preview-value em {
  color: var(--accent-light); font-style: normal;
  background: rgba(108,92,231,0.1); padding: 1px 4px; border-radius: 3px;
}

/* Bottom actions */
.vargen-actions {
  display: flex; justify-content: space-between; align-items: center;
  padding-top: 20px; border-top: 1px solid var(--border);
  margin-top: 8px;
}
.vargen-actions-info {
  font-size: 12px; color: var(--text-muted);
  display: flex; align-items: center; gap: 6px;
}

/* ═══════════ CAMPAIGNS DETAIL ═══════════ */
.campaigns-list { display: flex; flex-direction: column; gap: 12px; }

.campaign-row {
  display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr auto;
  align-items: center; gap: 16px;
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 18px 24px;
  cursor: pointer; transition: all 0.2s;
}
.campaign-row:hover { border-color: var(--accent); transform: translateY(-1px); }
.campaign-row-name { font-weight: 600; font-size: 15px; }
.campaign-row-meta { font-size: 12px; color: var(--text-muted); margin-top: 4px; }
.campaign-row-channel { font-size: 13px; font-weight: 500; }
.campaign-row-stat { text-align: center; }
.campaign-row-stat-value { font-size: 18px; font-weight: 700; }
.campaign-row-stat-label { font-size: 11px; color: var(--text-muted); margin-top: 2px; }
.campaign-row-arrow { font-size: 18px; color: var(--text-muted); transition: color 0.2s; }
.campaign-row:hover .campaign-row-arrow { color: var(--accent-light); }

/* Campaign detail view */
.campaign-detail { animation: fadeIn 0.3s ease; }
.campaign-detail-back {
  display: inline-flex; align-items: center; gap: 8px;
  font-size: 13px; font-weight: 500; color: var(--text-muted);
  cursor: pointer; transition: color 0.2s; margin-bottom: 20px;
  background: none; border: none; font-family: 'Outfit', sans-serif;
}
.campaign-detail-back:hover { color: var(--accent-light); }

.campaign-detail-header {
  display: flex; justify-content: space-between; align-items: flex-start;
  margin-bottom: 28px;
}
.campaign-detail-title { font-size: 24px; font-weight: 700; letter-spacing: -0.5px; }
.campaign-detail-tags { display: flex; gap: 8px; margin-top: 10px; flex-wrap: wrap; }
.campaign-tag {
  padding: 4px 12px; border-radius: 6px; font-size: 12px; font-weight: 500;
  background: var(--bg-elevated); color: var(--text-secondary); border: 1px solid var(--border);
}

.campaign-kpis {
  display: grid; grid-template-columns: repeat(5, 1fr); gap: 14px;
  margin-bottom: 28px;
}
.campaign-kpi {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 18px; text-align: center;
}
.campaign-kpi-value { font-size: 24px; font-weight: 700; }
.campaign-kpi-label { font-size: 11px; color: var(--text-muted); margin-top: 4px; }
.campaign-kpi-bar {
  width: 100%; height: 4px; background: var(--bg-elevated);
  border-radius: 2px; margin-top: 10px; overflow: hidden;
}
.campaign-kpi-fill { height: 100%; border-radius: 2px; }

/* Sequence timeline */
.sequence-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-lg); margin-bottom: 24px;
}
.sequence-header {
  padding: 20px 24px; border-bottom: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
}
.sequence-title { font-size: 15px; font-weight: 600; display: flex; align-items: center; gap: 8px; }

.sequence-steps { padding: 0; }
.sequence-step {
  display: grid; grid-template-columns: 60px 1fr 120px 120px 120px;
  align-items: center; gap: 16px;
  padding: 16px 24px;
  border-bottom: 1px solid var(--border);
  transition: background 0.2s;
}
.sequence-step:last-child { border-bottom: none; }
.sequence-step:hover { background: rgba(108, 92, 231, 0.03); }

.step-indicator {
  display: flex; flex-direction: column; align-items: center; gap: 4px;
}
.step-dot {
  width: 32px; height: 32px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 12px; font-weight: 700; color: white;
}
.step-dot.email { background: var(--blue); }
.step-dot.linkedin { background: var(--purple); }
.step-label { font-size: 10px; color: var(--text-muted); font-weight: 600; }

.step-content { }
.step-type { font-size: 13px; font-weight: 600; margin-bottom: 4px; }
.step-preview {
  font-size: 12px; color: var(--text-muted); line-height: 1.5;
  display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
}
.step-subject { font-size: 12px; color: var(--accent-light); margin-bottom: 2px; font-weight: 500; }

.step-stat { text-align: center; }
.step-stat-value { font-size: 16px; font-weight: 700; }
.step-stat-label { font-size: 10px; color: var(--text-muted); margin-top: 2px; }
.step-stat-bar {
  width: 100%; height: 3px; background: var(--bg-elevated);
  border-radius: 2px; margin-top: 6px; overflow: hidden;
}
.step-stat-fill { height: 100%; border-radius: 2px; }

/* Modification history */
.mod-history { display: flex; flex-direction: column; gap: 12px; }
.mod-item {
  display: flex; gap: 16px; padding: 14px 0;
  border-bottom: 1px solid var(--border);
}
.mod-item:last-child { border-bottom: none; }
.mod-version {
  width: 36px; height: 36px; border-radius: 50%;
  background: var(--bg-elevated); border: 2px solid var(--accent);
  display: flex; align-items: center; justify-content: center;
  font-size: 12px; font-weight: 700; color: var(--accent-light); flex-shrink: 0;
}
.mod-content { flex: 1; }
.mod-title { font-size: 14px; font-weight: 600; margin-bottom: 4px; }
.mod-desc { font-size: 12px; color: var(--text-muted); line-height: 1.5; }
.mod-result {
  display: inline-flex; align-items: center; gap: 4px;
  padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; margin-top: 6px;
}
.mod-result.improved { background: var(--success-bg); color: var(--success); }
.mod-result.testing { background: var(--warning-bg); color: var(--warning); }
.mod-result.neutral { background: var(--blue-bg); color: var(--blue); }
.mod-date { font-size: 11px; color: var(--text-muted); white-space: nowrap; }

/* ═══════════ COPY EDITOR ═══════════ */
.editor-layout {
  display: grid; grid-template-columns: 260px 1fr; gap: 0; min-height: calc(100vh - 160px);
}
.editor-sidebar {
  border-right: 1px solid var(--border); padding: 20px 0;
  background: var(--bg-secondary); border-radius: var(--radius-lg) 0 0 var(--radius-lg);
  overflow-y: auto;
}
.editor-sidebar-title {
  font-size: 11px; font-weight: 600; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 1px;
  padding: 0 20px; margin-bottom: 12px;
}
.editor-campaign-item {
  display: flex; align-items: center; gap: 12px;
  padding: 12px 20px; cursor: pointer; transition: all 0.2s;
  border-left: 3px solid transparent;
}
.editor-campaign-item:hover { background: var(--bg-card); }
.editor-campaign-item.active {
  background: var(--accent-glow); border-left-color: var(--accent);
}
.editor-campaign-item .eci-icon {
  width: 32px; height: 32px; border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px; flex-shrink: 0;
}
.editor-campaign-item .eci-name { font-size: 14px; font-weight: 600; }
.editor-campaign-item .eci-meta { font-size: 11px; color: var(--text-muted); margin-top: 2px; }
.editor-campaign-item.active .eci-name { color: var(--accent-light); }

.editor-main {
  padding: 28px; overflow-y: auto;
  background: var(--bg-primary); border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
}
.editor-header {
  display: flex; justify-content: space-between; align-items: flex-start;
  margin-bottom: 24px; padding-bottom: 20px; border-bottom: 1px solid var(--border);
}
.editor-header-title { font-size: 22px; font-weight: 700; letter-spacing: -0.5px; }
.editor-header-params {
  display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap;
}
.editor-param {
  padding: 3px 10px; border-radius: 6px; font-size: 11px; font-weight: 500;
  background: var(--bg-elevated); color: var(--text-secondary); border: 1px solid var(--border);
}

.ai-bar {
  background: var(--accent-glow); border: 1px solid rgba(108,92,231,0.2);
  border-radius: var(--radius); padding: 14px 20px; margin-bottom: 24px;
  display: flex; align-items: center; gap: 14px;
}
.ai-bar-icon {
  width: 36px; height: 36px; border-radius: 10px;
  background: linear-gradient(135deg, var(--accent), var(--accent-light));
  display: flex; align-items: center; justify-content: center;
  font-size: 16px; flex-shrink: 0;
}
.ai-bar-content { flex: 1; }
.ai-bar-title { font-size: 13px; font-weight: 600; color: var(--accent-light); }
.ai-bar-text { font-size: 12px; color: var(--text-secondary); margin-top: 2px; }

.touchpoint-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-lg); margin-bottom: 16px;
  transition: all 0.2s; overflow: hidden;
}
.touchpoint-card:hover { border-color: var(--border-light); }
.touchpoint-card.editing { border-color: var(--accent); box-shadow: 0 0 20px rgba(108,92,231,0.1); }

.tp-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 16px 20px; border-bottom: 1px solid var(--border);
}
.tp-header-left { display: flex; align-items: center; gap: 12px; }
.tp-dot {
  width: 36px; height: 36px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; font-weight: 700; color: white;
}
.tp-dot.email { background: var(--blue); }
.tp-dot.linkedin { background: var(--purple); }
.tp-info { }
.tp-name { font-size: 14px; font-weight: 600; }
.tp-timing { font-size: 12px; color: var(--text-muted); }
.tp-actions { display: flex; gap: 6px; }
.tp-action {
  padding: 6px 10px; border-radius: 6px; font-size: 11px; font-weight: 600;
  background: var(--bg-elevated); color: var(--text-secondary); border: 1px solid var(--border);
  cursor: pointer; transition: all 0.2s; font-family: 'Outfit', sans-serif;
}
.tp-action:hover { border-color: var(--accent); color: var(--accent-light); }
.tp-action.ai { background: var(--accent-glow); color: var(--accent-light); border-color: rgba(108,92,231,0.3); }

.tp-body { padding: 20px; }
.tp-field { margin-bottom: 16px; }
.tp-field:last-child { margin-bottom: 0; }
.tp-field-label {
  font-size: 11px; font-weight: 600; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px;
  display: flex; align-items: center; justify-content: space-between;
}
.tp-field-count { font-size: 11px; font-weight: 500; color: var(--text-muted); text-transform: none; letter-spacing: 0; }
.tp-field-count.warn { color: var(--warning); }
.tp-field-count.over { color: var(--danger); }

.tp-editable {
  background: var(--bg-elevated); border: 1px solid var(--border);
  border-radius: 8px; padding: 12px 16px;
  font-size: 14px; line-height: 1.6; color: var(--text-primary);
  cursor: text; transition: all 0.2s; min-height: 24px;
  font-family: 'Outfit', sans-serif;
}
.tp-editable:hover { border-color: var(--border-light); }
.tp-editable:focus { outline: none; border-color: var(--accent); background: var(--bg-card); }
.tp-editable[contenteditable="true"]:focus { box-shadow: 0 0 0 3px rgba(108,92,231,0.1); }
.tp-editable .var {
  background: rgba(108,92,231,0.15); color: var(--accent-light);
  padding: 1px 6px; border-radius: 4px; font-family: 'JetBrains Mono', monospace;
  font-size: 12px; font-weight: 500;
}

.tp-subject .tp-editable { font-weight: 600; }

.tp-ai-suggestion {
  background: var(--bg-elevated); border-left: 3px solid var(--accent);
  border-radius: 0 8px 8px 0; padding: 12px 16px; margin-top: 12px;
}
.tp-ai-suggestion-label { font-size: 11px; font-weight: 600; color: var(--accent-light); margin-bottom: 4px; }
.tp-ai-suggestion-text { font-size: 12px; color: var(--text-secondary); line-height: 1.5; }

.editor-bottom-bar {
  display: flex; justify-content: space-between; align-items: center;
  padding: 20px 0; margin-top: 8px; border-top: 1px solid var(--border);
}
.editor-bottom-info { font-size: 12px; color: var(--text-muted); }

/* ═══════════ VARIABLE MANAGER ═══════════ */
.var-panel {
  border-top: 1px solid var(--border);
  margin-top: 16px; padding-top: 16px;
}
.var-panel-toggle {
  display: flex; align-items: center; justify-content: space-between;
  cursor: pointer; padding: 8px 12px; border-radius: var(--radius-sm);
  transition: background 0.2s;
}
.var-panel-toggle:hover { background: var(--bg-card); }
.var-panel-toggle-left {
  display: flex; align-items: center; gap: 8px;
  font-size: 13px; font-weight: 600; color: var(--text-primary);
}
.var-panel-toggle .chevron {
  font-size: 10px; color: var(--text-muted);
  transition: transform 0.2s;
}
.var-panel-toggle.open .chevron { transform: rotate(90deg); }
.var-panel-count {
  font-size: 10px; font-weight: 600; color: var(--accent-light);
  background: var(--accent-glow); padding: 2px 7px; border-radius: 8px;
}

.var-panel-body {
  max-height: 0; overflow: hidden;
  transition: max-height 0.3s ease;
}
.var-panel-body.open { max-height: 600px; overflow-y: auto; }

.var-group { margin-top: 12px; }
.var-group-label {
  font-size: 10px; font-weight: 600; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 1px;
  padding: 0 12px; margin-bottom: 6px;
}
.var-list { display: flex; flex-direction: column; gap: 2px; }

.var-item {
  display: flex; align-items: center; gap: 8px;
  padding: 7px 12px; border-radius: 6px;
  cursor: pointer; transition: all 0.15s;
  position: relative;
}
.var-item:hover { background: var(--bg-card); }
.var-item-tag {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 500;
  color: var(--accent-light); background: rgba(108,92,231,0.12);
  padding: 2px 8px; border-radius: 4px;
  white-space: nowrap;
}
.var-item-label {
  font-size: 11px; color: var(--text-secondary);
  flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.var-item-sync {
  width: 16px; height: 16px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 8px; flex-shrink: 0;
}
.var-item-sync.synced { background: var(--success-bg); color: var(--success); }
.var-item-sync.custom { background: var(--warning-bg); color: var(--warning); }
.var-item-sync.local { background: var(--bg-elevated); color: var(--text-muted); }

.var-item-tooltip {
  display: none; position: absolute; left: 100%; top: 50%; transform: translateY(-50%);
  margin-left: 8px; padding: 6px 10px; border-radius: 6px;
  background: var(--bg-elevated); border: 1px solid var(--border);
  font-size: 11px; color: var(--text-secondary); white-space: nowrap;
  z-index: 200; box-shadow: var(--shadow);
}
.var-item:hover .var-item-tooltip { display: block; }

.var-add-btn {
  display: flex; align-items: center; justify-content: center; gap: 6px;
  width: 100%; padding: 8px 12px; margin-top: 10px;
  background: transparent; border: 1px dashed var(--border);
  border-radius: 6px; color: var(--text-muted); font-size: 12px;
  font-family: 'Outfit', sans-serif; cursor: pointer; transition: all 0.2s;
}
.var-add-btn:hover {
  border-color: var(--accent); color: var(--accent-light);
  background: var(--accent-glow);
}

/* Variable insert toolbar (appears above touchpoint body when editing) */
.var-insert-bar {
  display: none; flex-wrap: wrap; gap: 4px;
  padding: 8px 0; margin-bottom: 4px;
}
.touchpoint-card.editing .var-insert-bar { display: flex; }
.var-insert-chip {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; font-weight: 500;
  color: var(--accent-light); background: rgba(108,92,231,0.1);
  padding: 3px 8px; border-radius: 4px; border: 1px solid rgba(108,92,231,0.2);
  cursor: pointer; transition: all 0.15s;
  white-space: nowrap;
}
.var-insert-chip:hover {
  background: rgba(108,92,231,0.25); border-color: var(--accent);
}

/* Custom variable modal */
.var-modal-overlay {
  display: none; position: fixed; inset: 0;
  background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
  z-index: 1000; align-items: center; justify-content: center;
}
.var-modal-overlay.show { display: flex; }
.var-modal {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-lg); padding: 28px;
  width: 480px; max-width: 90vw; box-shadow: var(--shadow);
}
.var-modal-title {
  font-size: 18px; font-weight: 700; margin-bottom: 4px;
}
.var-modal-subtitle {
  font-size: 13px; color: var(--text-muted); margin-bottom: 24px;
}
.var-modal-field { margin-bottom: 16px; }
.var-modal-field label {
  display: block; font-size: 12px; font-weight: 600;
  color: var(--text-secondary); margin-bottom: 6px;
}
.var-modal-field input,
.var-modal-field select {
  width: 100%; padding: 10px 14px; border-radius: var(--radius-sm);
  background: var(--bg-elevated); border: 1px solid var(--border);
  color: var(--text-primary); font-size: 14px;
  font-family: 'Outfit', sans-serif; transition: border-color 0.2s;
}
.var-modal-field input:focus,
.var-modal-field select:focus {
  outline: none; border-color: var(--accent);
}
.var-modal-field input::placeholder { color: var(--text-muted); }
.var-modal-field .field-hint {
  font-size: 11px; color: var(--text-muted); margin-top: 4px;
}
.var-modal-preview {
  background: var(--bg-elevated); border: 1px solid var(--border);
  border-radius: var(--radius-sm); padding: 12px 16px;
  margin-bottom: 20px; display: flex; align-items: center; gap: 10px;
}
.var-modal-preview-label {
  font-size: 11px; color: var(--text-muted); white-space: nowrap;
}
.var-modal-preview-tag {
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px; font-weight: 500;
  color: var(--accent-light); background: rgba(108,92,231,0.15);
  padding: 3px 10px; border-radius: 4px;
}
.var-modal-actions {
  display: flex; justify-content: flex-end; gap: 10px;
  padding-top: 8px; border-top: 1px solid var(--border);
}

.var-item-actions {
  display: none; gap: 4px;
}
.var-item:hover .var-item-actions { display: flex; }
.var-item-action-btn {
  background: none; border: none; color: var(--text-muted);
  font-size: 10px; cursor: pointer; padding: 2px 4px; border-radius: 4px;
  transition: all 0.15s;
}
.var-item-action-btn:hover { color: var(--danger); background: var(--danger-bg); }

/* ═══════════ RECOMMANDATIONS IA ═══════════ */
.reco-page-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 28px;
}
.reco-page-title { font-size: 28px; font-weight: 700; letter-spacing: -0.5px; }
.reco-page-subtitle { color: var(--text-secondary); font-size: 14px; margin-top: 4px; }

.reco-stats {
  display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;
  margin-bottom: 28px;
}
.reco-stat-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 20px; text-align: center;
}
.reco-stat-value { font-size: 28px; font-weight: 700; letter-spacing: -1px; }
.reco-stat-label { font-size: 12px; color: var(--text-muted); margin-top: 4px; }
.reco-stat-trend { font-size: 12px; margin-top: 6px; }
.reco-stat-trend.up { color: var(--success); }

.reco-filters {
  display: flex; gap: 10px; margin-bottom: 24px; flex-wrap: wrap;
}
.reco-filter {
  padding: 7px 16px; border-radius: 20px; font-size: 13px; font-weight: 500;
  background: var(--bg-card); color: var(--text-secondary); border: 1px solid var(--border);
  cursor: pointer; transition: all 0.2s; font-family: 'Outfit', sans-serif;
}
.reco-filter:hover { border-color: var(--accent); color: var(--text-primary); }
.reco-filter.active { background: var(--accent-glow); color: var(--accent-light); border-color: var(--accent); }
.reco-filter .count {
  display: inline-block; margin-left: 6px; font-size: 11px; font-weight: 700;
  background: var(--bg-elevated); padding: 1px 7px; border-radius: 10px;
}
.reco-filter.active .count { background: rgba(108,92,231,0.3); }

.reco-list { display: flex; flex-direction: column; gap: 16px; }

.reco-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-lg); overflow: hidden;
  transition: all 0.2s;
}
.reco-card:hover { border-color: var(--border-light); }
.reco-card.priority-critical { border-left: 4px solid var(--danger); }
.reco-card.priority-important { border-left: 4px solid var(--warning); }
.reco-card.priority-suggestion { border-left: 4px solid var(--blue); }
.reco-card.priority-applied { border-left: 4px solid var(--success); opacity: 0.7; }

.reco-card-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 18px 24px; border-bottom: 1px solid var(--border);
}
.reco-card-left { display: flex; align-items: center; gap: 14px; }
.reco-priority-badge {
  padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: 700;
  text-transform: uppercase; letter-spacing: 0.3px;
}
.reco-priority-badge.critical { background: var(--danger-bg); color: var(--danger); }
.reco-priority-badge.important { background: var(--warning-bg); color: var(--warning); }
.reco-priority-badge.suggestion { background: var(--blue-bg); color: var(--blue); }
.reco-priority-badge.applied { background: var(--success-bg); color: var(--success); }

.reco-card-campaign { font-size: 14px; font-weight: 600; }
.reco-card-step { font-size: 12px; color: var(--text-muted); margin-top: 2px; }
.reco-card-meta { display: flex; align-items: center; gap: 12px; }
.reco-card-date { font-size: 11px; color: var(--text-muted); }
.reco-impact-badge {
  padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: 600;
  background: var(--success-bg); color: var(--success);
}

.reco-card-body { padding: 20px 24px; }
.reco-card-title { font-size: 15px; font-weight: 600; margin-bottom: 10px; }
.reco-card-desc { font-size: 13px; color: var(--text-secondary); line-height: 1.6; margin-bottom: 16px; }

.reco-diff {
  display: grid; grid-template-columns: 1fr 1fr; gap: 16px;
  margin-bottom: 16px;
}
.reco-diff-panel {
  background: var(--bg-elevated); border-radius: 8px; padding: 14px 16px;
}
.reco-diff-label {
  font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;
  margin-bottom: 8px; display: flex; align-items: center; gap: 6px;
}
.reco-diff-label.before { color: var(--danger); }
.reco-diff-label.after { color: var(--success); }
.reco-diff-text {
  font-size: 13px; line-height: 1.6; color: var(--text-secondary);
}
.reco-diff-text .highlight {
  background: rgba(0,214,143,0.15); padding: 1px 4px; border-radius: 3px;
  color: var(--success);
}
.reco-diff-text .strikethrough {
  text-decoration: line-through; color: var(--text-muted); opacity: 0.6;
}

.reco-card-actions {
  display: flex; gap: 8px; padding-top: 4px;
}
.reco-btn {
  padding: 8px 16px; border-radius: var(--radius-sm);
  font-family: 'Outfit', sans-serif; font-size: 12px; font-weight: 600;
  cursor: pointer; transition: all 0.2s; border: 1px solid var(--border);
  display: flex; align-items: center; gap: 6px;
}
.reco-btn.accept { background: var(--success); color: #0a0b0f; border-color: var(--success); }
.reco-btn.accept:hover { box-shadow: 0 4px 12px rgba(0,214,143,0.3); }
.reco-btn.modify { background: var(--bg-elevated); color: var(--accent-light); border-color: var(--accent); }
.reco-btn.modify:hover { background: var(--accent-glow); }
.reco-btn.dismiss { background: var(--bg-elevated); color: var(--text-muted); }
.reco-btn.dismiss:hover { color: var(--danger); border-color: var(--danger); }

.reco-applied-note {
  display: flex; align-items: center; gap: 8px;
  font-size: 12px; color: var(--success); font-weight: 500;
}

.reco-insight-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: var(--radius-lg); padding: 24px; margin-top: 28px;
}
.reco-insight-title {
  font-size: 15px; font-weight: 600; margin-bottom: 16px;
  display: flex; align-items: center; gap: 8px;
}
.reco-insight-grid {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;
}
.reco-insight-item {
  background: var(--bg-elevated); border-radius: 8px; padding: 16px;
  border-left: 3px solid var(--purple);
}
.reco-insight-item-title { font-size: 13px; font-weight: 600; margin-bottom: 6px; }
.reco-insight-item-text { font-size: 12px; color: var(--text-secondary); line-height: 1.5; }
.reco-insight-item-confidence {
  font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;
  margin-top: 8px; color: var(--text-muted);
}
.reco-insight-item-confidence.high { color: var(--success); }
.reco-insight-item-confidence.medium { color: var(--warning); }

/* ═══════════ RESPONSIVE ═══════════ */
@media (max-width: 1200px) {
  .kpi-grid { grid-template-columns: repeat(3, 1fr); }
  .section-grid { grid-template-columns: 1fr; }
  .campaign-row { grid-template-columns: 1fr 1fr; gap: 12px; }
  .campaign-kpis { grid-template-columns: repeat(3, 1fr); }
  .sequence-step { grid-template-columns: 50px 1fr; gap: 10px; }
  .sequence-step .step-stat { display: none; }
}
</style>
</head>
<body>

<!-- ═══════════ SIDEBAR ═══════════ -->
<aside class="sidebar">
  <div class="logo">
    <div class="logo-icon">B</div>
    <div class="logo-text">bakal<span>.ai</span></div>
  </div>
  <nav class="nav">
    <div class="nav-section">
      <div class="nav-label">Général</div>
      <div class="nav-item active" onclick="showPage('dashboard')"><span class="icon">📊</span> Dashboard <span class="badge">Live</span></div>
      <div class="nav-item"><span class="icon">🎯</span> Campagnes</div>
      <div class="nav-item"><span class="icon">🔥</span> Opportunités <span class="badge">3</span></div>
      <div class="nav-item"><span class="icon">📋</span> Rapports</div>
    </div>
    <div class="nav-section">
      <div class="nav-label">Configuration</div>
      <div class="nav-item"><span class="icon">🏢</span> Profil Entreprise</div>
      <div class="nav-item" onclick="showPage('copyeditor')"><span class="icon">✍️</span> Copy & Séquences</div>
      <div class="nav-item"><span class="icon">⚙️</span> Paramètres</div>
    </div>
    <div class="nav-section">
      <div class="nav-label">IA</div>
      <div class="nav-item"><span class="icon">🧬</span> Refinement A/B <span class="badge" style="background:var(--success);color:#0a0b0f;">New</span></div>
      <div class="nav-item" onclick="showPage('recos')"><span class="icon">💡</span> Recommandations IA <span class="badge" style="background:var(--danger);color:white;">3</span></div>
      <div class="nav-item"><span class="icon">🤖</span> Historique Claude</div>
    </div>
  </nav>
  <div class="sidebar-footer">
    <div class="user-card">
      <div class="user-avatar">FC</div>
      <div class="user-info">
        <div class="user-name">FormaPro Consulting</div>
        <div class="user-plan">Plan Pilot · S4/8</div>
      </div>
    </div>
  </div>
</aside>

<!-- ═══════════ MAIN CONTENT ═══════════ -->
<main class="main">
  <!-- Header -->
  <div class="page-header">
    <div>
      <div class="page-title">Dashboard</div>
      <div class="page-subtitle"><span class="pulse-dot"></span>&nbsp;&nbsp;2 campagnes actives · Semaine du 17 fév. 2026</div>
    </div>
    <div class="header-actions">
      <button class="btn btn-ghost">📥 Exporter le rapport</button>
      <button class="btn btn-primary" onclick="toggleCreator()">✨ Nouvelle campagne</button>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <div class="tab active" onclick="showSection('overview')">Vue d'ensemble</div>
    <div class="tab" onclick="showSection('reports')">Rapports hebdo</div>
    <div class="tab" onclick="showSection('campaigns')">Détail campagnes</div>
    <div class="tab" onclick="showSection('refinement')">🧬 Refinement A/B</div>
  </div>

  <!-- ═══════════ OVERVIEW (populated by campaigns-data.js) ═══════════ -->
  <div id="section-overview">
    <div class="kpi-grid"></div>

    <!-- Main Grid -->
    <div class="section-grid">
      <!-- Campaigns table -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">🎯 Campagnes actives</div>
          <button class="btn btn-ghost" style="padding: 6px 12px; font-size: 12px;" onclick="showSection('campaigns')">Voir tout →</button>
        </div>
        <div class="card-body" style="padding: 0;">
          <table class="campaign-table">
            <thead>
              <tr>
                <th>Campagne</th>
                <th>Canal</th>
                <th>Statut</th>
                <th>Ouvertures</th>
                <th>Réponses</th>
                <th>RDV</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <!-- Performance chart -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">📈 Performance 4 semaines</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <div class="chart-bars"></div>
          </div>
          <div class="chart-legend">
            <div class="chart-legend-item"><div class="chart-legend-dot" style="background:var(--blue)"></div> Email</div>
            <div class="chart-legend-item"><div class="chart-legend-dot" style="background:var(--purple)"></div> LinkedIn</div>
          </div>
        </div>
      </div>

      <!-- Opportunities -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">🔥 Opportunités récentes</div>
          <span class="badge" style="background:var(--danger-bg);color:var(--danger);padding:4px 10px;border-radius:6px;font-size:12px;font-weight:600;">3 nouvelles</span>
        </div>
        <div class="card-body" style="padding:16px 24px;">
          <div style="display:flex;flex-direction:column;gap:12px;"></div>
        </div>
      </div>

      <!-- AI Recommendations -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">💡 Recommandations Claude</div>
        </div>
        <div class="card-body">
          <div style="display:flex;flex-direction:column;gap:12px;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ═══════════ REPORTS (populated by campaigns-data.js) ═══════════ -->
  <div id="section-reports" style="display:none;"></div>

  <!-- ═══════════ CAMPAIGNS (populated by campaigns-data.js) ═══════════ -->
  <div id="section-campaigns" style="display:none;">

    <!-- Campaign List View -->
    <div id="campaigns-list-view">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
        <div>
          <div style="font-size:16px;font-weight:600;">0 campagnes</div>
          <div style="font-size:13px;color:var(--text-muted);">Cliquez sur une campagne pour voir le détail</div>
        </div>
        <div style="display:flex;gap:8px;">
          <button class="btn btn-ghost" style="font-size:12px;padding:8px 14px;">🔍 Filtrer</button>
          <button class="btn btn-ghost" style="font-size:12px;padding:8px 14px;">↕ Trier par perf.</button>
        </div>
      </div>
      <div class="campaigns-list"></div>
    </div>

  </div>

  <!-- ═══════════ REFINEMENT A/B SECTION ═══════════ -->
  <div id="section-refinement" style="display:none;">
    
    <!-- Overview Stats -->
    <div class="refine-overview">
      <div class="refine-stat-card">
        <div class="refine-stat-value" style="color:var(--accent-light)">12</div>
        <div class="refine-stat-label">Variantes testées (total)</div>
      </div>
      <div class="refine-stat-card">
        <div class="refine-stat-value" style="color:var(--success)">+4.1pts</div>
        <div class="refine-stat-label">Gain taux de réponse depuis le lancement</div>
      </div>
      <div class="refine-stat-card">
        <div class="refine-stat-value" style="color:var(--warning)">2</div>
        <div class="refine-stat-label">Tests A/B en cours</div>
      </div>
      <div class="refine-stat-card">
        <div class="refine-stat-value" style="color:var(--blue)">3</div>
        <div class="refine-stat-label">"Golden nuggets" identifiées</div>
      </div>
    </div>

    <!-- Active Test: Campaign DAF IDF -->
    <div class="card" style="margin-bottom:24px;">
      <div class="card-header">
        <div class="card-title">🧬 Test actif — Campagne "DAF Île-de-France"</div>
        <span style="font-size:12px;color:var(--text-muted);">Itération 4 · Lancé il y a 6 jours</span>
      </div>
      <div class="card-body" style="padding:16px 24px;">

        <!-- Variant A - Control / Winner -->
        <div class="variant-card winner">
          <div class="variant-header">
            <div class="variant-name">
              <span>Variante A</span>
              <span class="variant-badge winner">👑 Contrôle</span>
            </div>
            <span style="font-size:12px;color:var(--text-muted);">250 prospects · 6 jours</span>
          </div>
          <div class="variant-body">
            <div class="variant-message">
              <div class="subject">Objet : [Prénom], une question sur votre gestion financière</div>
              Angle : <strong>Douleur client</strong> — "Combien d'heures par semaine votre équipe passe-t-elle sur des tâches qui pourraient être automatisées ?"<br>
              CTA : Question ouverte · Ton : Conversationnel · Longueur : Court (3 phrases)
            </div>
            <div class="variant-metrics">
              <div class="variant-metric">
                <div class="variant-metric-value" style="color:var(--text-primary)">64%</div>
                <div class="variant-metric-label">Ouverture</div>
              </div>
              <div class="variant-metric">
                <div class="variant-metric-value" style="color:var(--success)">9.2%</div>
                <div class="variant-metric-label">Réponse</div>
              </div>
              <div class="variant-metric">
                <div class="variant-metric-value" style="color:var(--warning)">6</div>
                <div class="variant-metric-label">Intéressés</div>
              </div>
              <div class="variant-metric">
                <div class="variant-metric-value" style="color:var(--blue)">3</div>
                <div class="variant-metric-label">RDV</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Variant B - Challenger -->
        <div class="variant-card testing">
          <div class="variant-header">
            <div class="variant-name">
              <span>Variante B</span>
              <span class="variant-badge testing">⚡ Challenger</span>
            </div>
            <span style="font-size:12px;color:var(--text-muted);">250 prospects · 6 jours</span>
          </div>
          <div class="variant-body">
            <div class="variant-message">
              <div class="subject">Objet : [Prénom], vos concurrents font déjà ça</div>
              Angle : <strong>Douleur + Urgence</strong> — "3 cabinets sur 5 dans votre secteur ont automatisé ce processus l'an dernier. Et vous ?"<br>
              CTA : Stat provocante · Ton : Direct · Longueur : Ultra-court (2 phrases)
            </div>
            <div class="variant-metrics">
              <div class="variant-metric">
                <div class="variant-metric-value" style="color:var(--text-primary)">71%</div>
                <div class="variant-metric-label">Ouverture</div>
              </div>
              <div class="variant-metric">
                <div class="variant-metric-value" style="color:var(--success)">7.8%</div>
                <div class="variant-metric-label">Réponse</div>
              </div>
              <div class="variant-metric">
                <div class="variant-metric-value" style="color:var(--warning)">4</div>
                <div class="variant-metric-label">Intéressés</div>
              </div>
              <div class="variant-metric">
                <div class="variant-metric-value" style="color:var(--blue)">1</div>
                <div class="variant-metric-label">RDV</div>
              </div>
            </div>
          </div>
        </div>

        <!-- AI Analysis -->
        <div style="background:var(--bg-elevated);border-radius:12px;padding:20px;margin-top:8px;border-left:3px solid var(--accent);">
          <div style="font-size:12px;font-weight:600;color:var(--accent-light);margin-bottom:8px;">🤖 Analyse Claude — Itération 4</div>
          <div style="font-size:13px;color:var(--text-secondary);line-height:1.65;">
            <strong>Variante A reste le contrôle.</strong> Malgré un meilleur taux d'ouverture (+7pts) grâce à l'objet provocant, la Variante B convertit moins en RDV (ratio réponse→RDV de 12.5% vs 33% pour A). L'angle urgence ouvre la curiosité mais crée une réaction défensive chez les DAF.<br><br>
            <strong>Prochaine itération proposée :</strong> Variante C — garder la longueur ultra-courte de B (meilleure ouverture) mais revenir sur l'angle douleur client de A avec un CTA question ouverte. Hypothèse : combiner les forces des deux variantes.
          </div>
          <div style="display:flex;gap:8px;margin-top:14px;">
            <button class="btn btn-success" style="font-size:12px;padding:8px 14px;" onclick="launchVariantC(this)">✅ Lancer Variante C</button>
            <button class="btn btn-ghost" style="font-size:12px;padding:8px 14px;" onclick="modifyProposition(this)">✏️ Modifier la proposition</button>
            <button class="btn btn-ghost" style="font-size:12px;padding:8px 14px;" onclick="pauseTest(this)">⏸ Pause le test</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ═══ Variable Generator ═══ -->
    <div class="vargen-card" id="vargen-card">
      <div class="vargen-header">
        <div class="vargen-header-left">
          <div class="vargen-header-icon">🧬</div>
          <div>
            <div class="vargen-header-title">Générateur de variables</div>
            <div class="vargen-header-subtitle">Variables stratégiques suggérées par l'IA en fonction de votre industrie et vos campagnes</div>
          </div>
        </div>
        <div style="display:flex;gap:8px;">
          <button class="btn btn-ghost" style="font-size:12px;padding:8px 14px;" onclick="regenerateVarSuggestions()">🔄 Régénérer</button>
          <button class="btn btn-primary" style="font-size:12px;padding:8px 14px;" onclick="acceptAllVarSuggestions()">✅ Tout accepter</button>
        </div>
      </div>

      <!-- Context bar: which campaign / industry drives these suggestions -->
      <div class="vargen-context" id="vargen-context"></div>

      <div class="vargen-body" id="vargen-body">
        <!-- Populated by JS -->
      </div>
    </div>

    <!-- Learning Memory -->
    <div class="refine-timeline">
      <div class="refine-timeline-title">🧠 Mémoire d'apprentissage — FormaPro Consulting</div>
      
      <div class="timeline-item">
        <div class="timeline-dot green"></div>
        <div class="timeline-content">
          <div class="timeline-action">Golden nugget trouvée — Angle "douleur client" + CTA question ouverte</div>
          <div class="timeline-detail">Campagne DAF IDF · 9.2% de taux de réponse · Itération 3→4</div>
          <div class="learning-card">
            <div class="label">💎 Apprentissage validé</div>
            <div class="text">L'angle "douleur client" surperforme systématiquement de +3.2pts vs "preuve sociale" sur le segment comptabilité/finance. Le CTA question ouverte génère 2x plus de réponses que le CTA proposition de call.</div>
          </div>
        </div>
        <div class="timeline-date">Il y a 3 jours</div>
      </div>

      <div class="timeline-item">
        <div class="timeline-dot blue"></div>
        <div class="timeline-content">
          <div class="timeline-action">Optimisation horaire détectée</div>
          <div class="timeline-detail">Cross-campagnes · +15% d'ouverture le mardi 9h-10h</div>
          <div class="learning-card">
            <div class="label">📊 Pattern identifié</div>
            <div class="text">Les emails envoyés le mardi matin (9h-10h) ont un taux d'ouverture 15% supérieur. Ce créneau est désormais appliqué automatiquement à toutes les nouvelles campagnes.</div>
          </div>
        </div>
        <div class="timeline-date">Semaine 3</div>
      </div>

      <div class="timeline-item">
        <div class="timeline-dot orange"></div>
        <div class="timeline-content">
          <div class="timeline-action">Angle "preuve sociale" abandonné sur segment finance</div>
          <div class="timeline-detail">2 tests consécutifs sous-performants (4.1% et 5.0% de réponse)</div>
        </div>
        <div class="timeline-date">Semaine 2</div>
      </div>

      <div class="timeline-item">
        <div class="timeline-dot purple"></div>
        <div class="timeline-content">
          <div class="timeline-action">Premier test A/B lancé</div>
          <div class="timeline-detail">Campagne DAF IDF · Angle douleur vs preuve sociale · 100 prospects chacun</div>
        </div>
        <div class="timeline-date">Semaine 1</div>
      </div>
    </div>

  </div>

  <!-- ═══════════ COPY & SEQUENCES EDITOR ═══════════ -->
  <div id="page-copyeditor" style="display:none;">
    <div class="page-header">
      <div>
        <div class="page-title">Copy & Séquences</div>
        <div class="page-subtitle">Éditeur de messages — 3 campagnes · 12 touchpoints</div>
      </div>
      <div class="header-actions">
        <button class="btn btn-ghost">📥 Exporter tout</button>
        <button class="btn btn-primary">✨ Générer une séquence</button>
      </div>
    </div>
    <div class="editor-layout">
      <div class="editor-sidebar">
        <div class="editor-sidebar-title">Campagnes</div>
        <div id="editor-campaign-list"></div>
        <div style="border-top:1px solid var(--border);margin:16px 0;"></div>
        <div class="editor-sidebar-title">Bibliothèque</div>
        <div class="editor-campaign-item" style="opacity:0.5;cursor:default;">
          <div class="eci-icon" style="background:var(--bg-elevated);">📚</div>
          <div><div class="eci-name" style="font-size:13px;">Modèles sauvegardés</div><div class="eci-meta">3 modèles</div></div>
        </div>
        <div class="editor-campaign-item" style="opacity:0.5;cursor:default;">
          <div class="eci-icon" style="background:var(--bg-elevated);">💎</div>
          <div><div class="eci-name" style="font-size:13px;">Golden nuggets</div><div class="eci-meta">5 apprentissages</div></div>
        </div>

        <!-- Variable Manager Panel -->
        <div class="var-panel" id="var-panel">
          <div class="var-panel-toggle" id="var-panel-toggle" onclick="toggleVarPanel()">
            <div class="var-panel-toggle-left">
              <span>🔗</span>
              <span>Variables</span>
              <span class="var-panel-count" id="var-panel-count">15</span>
            </div>
            <span class="chevron">▶</span>
          </div>
          <div class="var-panel-body" id="var-panel-body"></div>
        </div>
      </div>
      <div class="editor-main" id="editor-main-content"></div>
    </div>
  </div>

  <!-- Custom Variable Modal -->
  <div class="var-modal-overlay" id="var-modal-overlay" onclick="if(event.target===this)closeVarModal()">
    <div class="var-modal">
      <div class="var-modal-title">Nouvelle variable</div>
      <div class="var-modal-subtitle">Créez une variable personnalisée à utiliser dans vos séquences et synchroniser avec Lemlist.</div>

      <div class="var-modal-field">
        <label>Nom de la variable</label>
        <input type="text" id="var-modal-name" placeholder="ex: revenuAnnuel, dernierPost, nbEmployes..." oninput="updateVarPreview()">
        <div class="field-hint">Utilisez le camelCase, sans espaces ni caractères spéciaux.</div>
      </div>

      <div class="var-modal-field">
        <label>Description</label>
        <input type="text" id="var-modal-desc" placeholder="ex: Chiffre d'affaires annuel estimé du prospect">
      </div>

      <div class="var-modal-field">
        <label>Valeur par défaut (optionnel)</label>
        <input type="text" id="var-modal-default" placeholder="ex: votre entreprise">
        <div class="field-hint">Utilisée quand la donnée n'est pas disponible pour un prospect.</div>
      </div>

      <div class="var-modal-field">
        <label>Catégorie</label>
        <select id="var-modal-category">
          <option value="prospect">Prospect</option>
          <option value="company">Entreprise</option>
          <option value="enrichment">Enrichissement</option>
          <option value="custom">Personnalisé</option>
        </select>
      </div>

      <div class="var-modal-field">
        <label>Synchronisation Lemlist</label>
        <select id="var-modal-sync">
          <option value="push">Push vers Lemlist (créer le champ)</option>
          <option value="pull">Pull depuis Lemlist (champ existant)</option>
          <option value="bidirectional">Bidirectionnel</option>
          <option value="local">Local uniquement (pas de sync)</option>
        </select>
        <div class="field-hint">Définit comment la variable est synchronisée avec vos outils externes.</div>
      </div>

      <div class="var-modal-preview" id="var-modal-preview">
        <span class="var-modal-preview-label">Prévisualisation :</span>
        <span class="var-modal-preview-tag" id="var-modal-preview-tag">{{maVariable}}</span>
      </div>

      <div class="var-modal-actions">
        <button class="btn btn-ghost" style="font-size:13px;padding:8px 18px;" onclick="closeVarModal()">Annuler</button>
        <button class="btn btn-primary" style="font-size:13px;padding:8px 18px;" onclick="createCustomVariable()">Créer la variable</button>
      </div>
    </div>
  </div>

  <!-- ═══════════ RECOMMANDATIONS IA PAGE ═══════════ -->
  <div id="page-recos" style="display:none;">
    <div class="reco-page-header">
      <div>
        <div class="reco-page-title">Recommandations IA</div>
        <div class="reco-page-subtitle">Claude analyse vos campagnes et propose des optimisations · Mis à jour il y a 2h</div>
      </div>
      <div class="header-actions">
        <button class="btn btn-ghost">📋 Historique</button>
        <button class="btn btn-primary">🔄 Relancer l'analyse</button>
      </div>
    </div>

    <!-- Stats -->
    <div class="reco-stats">
      <div class="reco-stat-card">
        <div class="reco-stat-value" style="color:var(--accent-light);">12</div>
        <div class="reco-stat-label">Recommandations totales</div>
        <div class="reco-stat-trend up">4 nouvelles cette semaine</div>
      </div>
      <div class="reco-stat-card">
        <div class="reco-stat-value" style="color:var(--success);">7</div>
        <div class="reco-stat-label">Appliquées</div>
        <div class="reco-stat-trend up">▲ +4.2pts réponse en moyenne</div>
      </div>
      <div class="reco-stat-card">
        <div class="reco-stat-value" style="color:var(--warning);">3</div>
        <div class="reco-stat-label">En attente</div>
        <div class="reco-stat-trend" style="color:var(--warning);">1 critique</div>
      </div>
      <div class="reco-stat-card">
        <div class="reco-stat-value" style="color:var(--text-muted);">2</div>
        <div class="reco-stat-label">Ignorées</div>
        <div class="reco-stat-trend" style="color:var(--text-muted);">—</div>
      </div>
    </div>

    <!-- Filters -->
    <div class="reco-filters">
      <button class="reco-filter active">Toutes <span class="count">5</span></button>
      <button class="reco-filter">Critiques <span class="count">1</span></button>
      <button class="reco-filter">Importantes <span class="count">2</span></button>
      <button class="reco-filter">Suggestions <span class="count">1</span></button>
      <button class="reco-filter">Appliquées <span class="count">1</span></button>
      <span style="border-left:1px solid var(--border);margin:0 4px;"></span>
      <button class="reco-filter">DAF Île-de-France</button>
      <button class="reco-filter">Dirigeants Formation</button>
      <button class="reco-filter">DRH PME Lyon</button>
    </div>

    <!-- Recommendation Cards -->
    <div class="reco-list">

      <!-- RECO 1: Critical -->
      <div class="reco-card priority-critical">
        <div class="reco-card-header">
          <div class="reco-card-left">
            <span class="reco-priority-badge critical">Critique</span>
            <div>
              <div class="reco-card-campaign">DRH PME Lyon</div>
              <div class="reco-card-step">E1 — Email initial · Offre directe</div>
            </div>
          </div>
          <div class="reco-card-meta">
            <span class="reco-impact-badge">+2-3pts reply estimé</span>
            <span class="reco-card-date">Il y a 1h</span>
          </div>
        </div>
        <div class="reco-card-body">
          <div class="reco-card-title">Remplacer le CTA agressif par une question ouverte</div>
          <div class="reco-card-desc">
            Le CTA "Seriez-vous disponible 15 minutes cette semaine ?" est trop direct pour un premier contact DRH.
            Vos données cross-campagne montrent que les <strong>questions ouvertes</strong> sur les pain points
            génèrent 2x plus de réponses que les propositions de call directes sur ce segment.
          </div>

          <div class="reco-diff">
            <div class="reco-diff-panel">
              <div class="reco-diff-label before">Actuel</div>
              <div class="reco-diff-text">
                Nous aidons des DRH de PME comme {{companyName}} à réduire de 40% leur temps de recrutement.
                <span class="strikethrough">Seriez-vous disponible 15 minutes cette semaine pour en discuter ?</span>
              </div>
            </div>
            <div class="reco-diff-panel">
              <div class="reco-diff-label after">Proposition Claude</div>
              <div class="reco-diff-text">
                Nous aidons des DRH de PME comme {{companyName}} à réduire de 40% leur temps de recrutement.
                <span class="highlight">Quel est votre plus gros défi recrutement en ce moment ?</span>
              </div>
            </div>
          </div>

          <div class="reco-card-actions">
            <button class="reco-btn accept" onclick="applyReco(this)">✅ Appliquer</button>
            <button class="reco-btn modify" onclick="modifyReco(this)">✏️ Modifier avant d'appliquer</button>
            <button class="reco-btn dismiss" onclick="dismissReco(this)">Ignorer</button>
          </div>
        </div>
      </div>

      <!-- RECO 2: Important -->
      <div class="reco-card priority-important">
        <div class="reco-card-header">
          <div class="reco-card-left">
            <span class="reco-priority-badge important">Important</span>
            <div>
              <div class="reco-card-campaign">DAF Île-de-France</div>
              <div class="reco-card-step">E3 — Email relance · J+7</div>
            </div>
          </div>
          <div class="reco-card-meta">
            <span class="reco-impact-badge">+2.1pts reply estimé</span>
            <span class="reco-card-date">Il y a 3h</span>
          </div>
        </div>
        <div class="reco-card-body">
          <div class="reco-card-title">Remplacer l'angle "coût de l'erreur" par "gain de temps"</div>
          <div class="reco-card-desc">
            L'E3 a un taux de réponse de seulement 1.4% (vs 4.2% sur E1). L'angle anxiogène
            "coût d'une erreur de saisie" est mal reçu par les DAF qui y voient une remise en question de leur compétence.
            Votre mémoire cross-campagne montre que l'angle positif <strong>"gain de temps"</strong> performe
            systématiquement mieux (+2.1pts en moyenne) sur le segment Comptabilité/Finance.
          </div>

          <div class="reco-diff">
            <div class="reco-diff-panel">
              <div class="reco-diff-label before">Actuel</div>
              <div class="reco-diff-text">
                {{firstName}}, je change d'approche. Plutôt que de parler d'automatisation, une question simple :
                <span class="strikethrough">quel est le coût réel d'une erreur de saisie dans un bilan chez {{companyName}} ?</span>
              </div>
            </div>
            <div class="reco-diff-panel">
              <div class="reco-diff-label after">Proposition Claude</div>
              <div class="reco-diff-text">
                {{firstName}}, une question différente :
                <span class="highlight">si vous pouviez récupérer une journée complète par semaine pour du conseil à valeur ajoutée, qu'en feriez-vous ?</span>
                C'est exactement ce que nos clients dans la finance ont obtenu.
              </div>
            </div>
          </div>

          <div class="reco-card-actions">
            <button class="reco-btn accept" onclick="applyReco(this)">✅ Appliquer</button>
            <button class="reco-btn modify" onclick="modifyReco(this)">✏️ Modifier avant d'appliquer</button>
            <button class="reco-btn dismiss" onclick="dismissReco(this)">Ignorer</button>
          </div>
        </div>
      </div>

      <!-- RECO 3: Important -->
      <div class="reco-card priority-important">
        <div class="reco-card-header">
          <div class="reco-card-left">
            <span class="reco-priority-badge important">Important</span>
            <div>
              <div class="reco-card-campaign">Dirigeants Formation</div>
              <div class="reco-card-step">L2 — Message post-connexion LinkedIn</div>
            </div>
          </div>
          <div class="reco-card-meta">
            <span class="reco-impact-badge">+1.5pts reply estimé</span>
            <span class="reco-card-date">Il y a 5h</span>
          </div>
        </div>
        <div class="reco-card-body">
          <div class="reco-card-title">Passer de preuve sociale vers angle douleur client</div>
          <div class="reco-card-desc">
            Le taux de réponse LinkedIn (6.8%) est sous l'objectif de 8%. Le message actuel utilise une preuve
            sociale vague ("3 organismes de formation") qui manque de spécificité. Les données montrent
            que les <strong>questions directes sur les pain points</strong> fonctionnent mieux sur LinkedIn
            car le format conversationnel s'y prête naturellement.
          </div>

          <div class="reco-diff">
            <div class="reco-diff-panel">
              <div class="reco-diff-label before">Actuel</div>
              <div class="reco-diff-text">
                Merci d'avoir accepté, {{firstName}} !
                <span class="strikethrough">J'ai accompagné 3 organismes de formation comme le vôtre à générer entre 5 et 12 RDV qualifiés par mois.</span>
                Curieux de savoir comment vous gérez votre développement commercial actuellement ?
              </div>
            </div>
            <div class="reco-diff-panel">
              <div class="reco-diff-label after">Proposition Claude</div>
              <div class="reco-diff-text">
                Merci d'avoir accepté, {{firstName}} !
                <span class="highlight">Quel est votre plus gros frein pour trouver de nouveaux clients en ce moment ?</span>
                Je pose la question car c'est un sujet qui revient souvent chez les dirigeants d'organismes de formation.
              </div>
            </div>
          </div>

          <div class="reco-card-actions">
            <button class="reco-btn accept" onclick="applyReco(this)">✅ Appliquer</button>
            <button class="reco-btn modify" onclick="modifyReco(this)">✏️ Modifier avant d'appliquer</button>
            <button class="reco-btn dismiss" onclick="dismissReco(this)">Ignorer</button>
          </div>
        </div>
      </div>

      <!-- RECO 4: Suggestion -->
      <div class="reco-card priority-suggestion">
        <div class="reco-card-header">
          <div class="reco-card-left">
            <span class="reco-priority-badge suggestion">Suggestion</span>
            <div>
              <div class="reco-card-campaign">DAF Île-de-France</div>
              <div class="reco-card-step">E4 — Email break-up · J+12</div>
            </div>
          </div>
          <div class="reco-card-meta">
            <span class="reco-card-date">Il y a 5h</span>
          </div>
        </div>
        <div class="reco-card-body">
          <div class="reco-card-title">Raccourcir le break-up de 4 phrases à 3</div>
          <div class="reco-card-desc">
            Le break-up actuel fait 4 phrases, l'objectif est 3 max. La phrase "Juste un dernier mot : si un jour
            12h/semaine..." peut être fusionnée avec la précédente. Impact faible mais aligné avec les bonnes pratiques
            de break-up email (court = plus de respect perçu = meilleure image de marque).
          </div>

          <div class="reco-diff">
            <div class="reco-diff-panel">
              <div class="reco-diff-label before">Actuel (4 phrases)</div>
              <div class="reco-diff-text">
                {{firstName}}, je ne veux pas encombrer votre boîte.<br>
                Si ce n'est pas le bon moment, pas de souci — je ne reviendrai pas.<br>
                <span class="strikethrough">Juste un dernier mot : si un jour 12h/semaine récupérées ça vous intéresse, mon agenda est ouvert.</span><br>
                Bonne continuation.
              </div>
            </div>
            <div class="reco-diff-panel">
              <div class="reco-diff-label after">Proposition (3 phrases)</div>
              <div class="reco-diff-text">
                {{firstName}}, je ne veux pas encombrer votre boîte.<br>
                <span class="highlight">Si ce n'est pas le bon moment, aucun souci — mon agenda reste ouvert si un jour 12h/semaine récupérées vous intéressent.</span><br>
                Bonne continuation.
              </div>
            </div>
          </div>

          <div class="reco-card-actions">
            <button class="reco-btn accept" onclick="applyReco(this)">✅ Appliquer</button>
            <button class="reco-btn modify" onclick="modifyReco(this)">✏️ Modifier</button>
            <button class="reco-btn dismiss" onclick="dismissReco(this)">Ignorer</button>
          </div>
        </div>
      </div>

      <!-- RECO 5: Applied -->
      <div class="reco-card priority-applied">
        <div class="reco-card-header">
          <div class="reco-card-left">
            <span class="reco-priority-badge applied">Appliquée</span>
            <div>
              <div class="reco-card-campaign">DAF Île-de-France</div>
              <div class="reco-card-step">E1 — Objet email initial</div>
            </div>
          </div>
          <div class="reco-card-meta">
            <span class="reco-impact-badge">▲ +8pts ouverture</span>
            <span class="reco-card-date">3 fév.</span>
          </div>
        </div>
        <div class="reco-card-body">
          <div class="reco-card-title">Personnaliser l'objet avec {{firstName}} + question sectorielle</div>
          <div class="reco-card-desc">
            Remplacement de l'objet générique par un objet personnalisé avec le prénom du prospect et une question
            ciblée sur le secteur. Résultat : <strong>+8 points de taux d'ouverture</strong> (de 60% à 68%).
          </div>
          <div class="reco-applied-note">
            ✅ Appliquée le 3 fév. · Résultat confirmé après 150 prospects · Itération v2 → v3
          </div>
        </div>
      </div>

    </div>

    <!-- Cross-Campaign Insights -->
    <div class="reco-insight-card">
      <div class="reco-insight-title">🧠 Patterns cross-campagne détectés</div>
      <div class="reco-insight-grid">
        <div class="reco-insight-item">
          <div class="reco-insight-item-title">Questions ouvertes > CTA directs</div>
          <div class="reco-insight-item-text">
            Les CTA sous forme de question ("Quel est votre plus gros frein...?") génèrent 2.1x plus de réponses
            que les propositions de call directes. Observé sur les 3 campagnes actives.
          </div>
          <div class="reco-insight-item-confidence high">Confiance haute · 400+ prospects</div>
        </div>
        <div class="reco-insight-item">
          <div class="reco-insight-item-title">Angle positif > anxiogène</div>
          <div class="reco-insight-item-text">
            "Gain de temps" et "récupérer X heures" performent +2.1pts mieux que "coût de l'erreur" et "risque de..."
            sur les profils finance et RH.
          </div>
          <div class="reco-insight-item-confidence medium">Confiance moyenne · 150 prospects</div>
        </div>
        <div class="reco-insight-item">
          <div class="reco-insight-item-title">"Re:" booste les ouvertures</div>
          <div class="reco-insight-item-text">
            Utiliser "Re:" dans l'objet des follow-ups augmente le taux d'ouverture de +4pts en moyenne.
            Fonctionne mieux que les objets complètement différents.
          </div>
          <div class="reco-insight-item-confidence high">Confiance haute · 250+ prospects</div>
        </div>
      </div>
    </div>
  </div>

</main>

<!-- ═══════════ CAMPAIGN CREATOR MODAL ═══════════ -->
<div class="creator-overlay" id="creatorModal">
  <div class="creator-modal">
    <div class="creator-header">
      <h2>✨ Nouvelle campagne</h2>
      <button class="creator-close" onclick="toggleCreator()">✕</button>
    </div>
    <div class="creator-body">
      <div class="form-grid">
        <div class="form-group full">
          <label class="form-label">Nom de la campagne</label>
          <input class="form-input" id="creator-name" placeholder="Ex: DRH PME Lyon — Mars 2026">
        </div>
        <div class="form-group">
          <label class="form-label">Cible — Secteur</label>
          <select class="form-select" id="creator-sector">
            <option>Formation & Éducation</option>
            <option>Comptabilité & Finance</option>
            <option>Juridique & Avocats</option>
            <option>Conseil & Consulting</option>
            <option>IT & Infogérance</option>
            <option>Immobilier B2B</option>
            <option>Santé & Médical</option>
            <option>Marketing & Communication</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Cible — Poste décideur</label>
          <select class="form-select" id="creator-position">
            <option>Dirigeant / Gérant / CEO</option>
            <option>DG / Directeur Général</option>
            <option>DAF / Directeur Financier</option>
            <option>DRH / Directeur RH</option>
            <option>Directeur Commercial</option>
            <option>DSI / Directeur IT</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Taille entreprise</label>
          <select class="form-select" id="creator-size">
            <option>1-10 salariés</option>
            <option>11-50 salariés</option>
            <option>51-200 salariés</option>
            <option>200+ salariés</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Zone géographique</label>
          <select class="form-select" id="creator-zone">
            <option>Île-de-France</option>
            <option>Lyon & Rhône-Alpes</option>
            <option>Marseille & PACA</option>
            <option>France entière</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Ton</label>
          <select class="form-select" id="creator-tone">
            <option>Pro décontracté</option>
            <option>Formel & Corporate</option>
            <option>Direct & punchy</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Canal</label>
          <select class="form-select" id="creator-channel">
            <option>Email + LinkedIn</option>
            <option>Email uniquement</option>
            <option>LinkedIn uniquement</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Angle d'approche</label>
          <select class="form-select" id="creator-angle">
            <option>Douleur client</option>
            <option>Preuve sociale</option>
            <option>Offre directe</option>
            <option>Contenu éducatif</option>
            <option>Laisser Claude choisir</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Volume</label>
          <select class="form-select" id="creator-volume">
            <option>Standard (~100/semaine)</option>
            <option>Modéré (~50/semaine)</option>
            <option>Agressif (~200/semaine)</option>
          </select>
        </div>

        <!-- Inspiration toggle -->
        <div class="inspiration-toggle" onclick="toggleInspiration()">
          <div class="toggle-switch" id="inspiToggle"></div>
          <div class="inspiration-text">
            <h4>💡 Besoin d'inspiration</h4>
            <p>Claude analyse vos campagnes passées et vous propose une campagne optimisée de A à Z</p>
          </div>
        </div>

        <!-- Inspiration panel -->
        <div class="inspiration-panel" id="inspiPanel">
          <div class="inspi-header">
            <div class="inspi-icon">🤖</div>
            <div>
              <div class="inspi-title">Proposition de Claude</div>
              <div class="inspi-sub">Basée sur l'analyse de 2 campagnes et 652 contacts</div>
            </div>
          </div>
          <div class="inspi-suggestion">
            <h5>🎯 Campagne recommandée : "Dirigeants Comptabilité IdF — Douleur"</h5>
            <div class="inspi-params">
              <div class="inspi-param">
                <div class="inspi-param-label">Secteur</div>
                <div class="inspi-param-value">Comptabilité & Finance</div>
              </div>
              <div class="inspi-param">
                <div class="inspi-param-label">Poste</div>
                <div class="inspi-param-value">Dirigeant / CEO</div>
              </div>
              <div class="inspi-param">
                <div class="inspi-param-label">Taille</div>
                <div class="inspi-param-value">11-50 salariés</div>
              </div>
              <div class="inspi-param">
                <div class="inspi-param-label">Zone</div>
                <div class="inspi-param-value">Île-de-France</div>
              </div>
              <div class="inspi-param">
                <div class="inspi-param-label">Canal</div>
                <div class="inspi-param-value">Email + LinkedIn</div>
              </div>
              <div class="inspi-param">
                <div class="inspi-param-label">Volume</div>
                <div class="inspi-param-value">Standard (~100/sem)</div>
              </div>
            </div>
            <div class="inspi-reason">
              <strong>Pourquoi cette campagne :</strong> Votre meilleur taux de conversion (9.2%) vient du segment DAF/Comptabilité. En ciblant les dirigeants (au lieu des DAF), vous touchez le décideur final — vos données montrent +11.3% de taux de réponse sur ce poste. L'angle "douleur client" surperforme de 3.2pts dans ce secteur. Le canal hybride combine le reach email (62% d'ouverture) et la conversion LinkedIn (33% de ratio réponse→RDV).
            </div>
            <div class="inspi-actions">
              <button class="btn btn-success" style="font-size:13px;" onclick="applyInspirationSuggestion()">✅ Lancer cette campagne</button>
              <button class="btn btn-ghost" style="font-size:13px;">🔄 Autre suggestion</button>
              <button class="btn btn-ghost" style="font-size:13px;" onclick="closeInspirationToEdit()">✏️ Modifier les paramètres</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="creator-footer" id="creatorFooter">
      <button class="btn btn-ghost" onclick="toggleCreator()">Annuler</button>
      <button class="btn btn-primary" onclick="createCampaign()">🚀 Créer la campagne</button>
    </div>
  </div>
</div>

<script src="campaigns-data.js"></script>
<script src="nav.js"></script>
<script src="campaigns-detail.js"></script>
<script src="copy-editor.js"></script>
<script src="variables.js"></script>
<script src="vargen.js"></script>
<script src="recos.js"></script>
<script src="app.js"></script>

</body>
</html>
